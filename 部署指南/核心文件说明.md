# æ ¸å¿ƒéƒ¨ç½²æ–‡ä»¶ä½ç½®å’Œå†…å®¹è¯´æ˜Ž

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜Žéƒ¨ç½²æ‰€éœ€çš„æ ¸å¿ƒæ–‡ä»¶åº”è¯¥åˆ›å»ºåœ¨å“ªé‡Œï¼Œä»¥åŠå®ƒä»¬çš„å…·ä½“å†…å®¹ã€‚

---

## ðŸ“ æ–‡ä»¶ä½ç½®æ€»è§ˆ

```
TheProjectSan/                    # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ Dockerfile                    # âš ï¸ éœ€è¦åˆ›å»º - åŽç«¯Dockeré•œåƒé…ç½®
â”œâ”€â”€ docker-compose.yml            # âš ï¸ éœ€è¦åˆ›å»º - Docker Composeç¼–æŽ’é…ç½®
â”œâ”€â”€ Caddyfile                     # âš ï¸ éœ€è¦åˆ›å»º - Caddyåå‘ä»£ç†é…ç½®
â”œâ”€â”€ .env                          # âš ï¸ éœ€è¦åˆ›å»º - çŽ¯å¢ƒå˜é‡ï¼ˆä¸æäº¤åˆ°Gitï¼‰
â”œâ”€â”€ conf.yaml                     # âœ… å·²å­˜åœ¨ - ä¸»é…ç½®æ–‡ä»¶ï¼ˆä¸æäº¤åˆ°Gitï¼‰
â”œâ”€â”€ requirements.linux.txt       # âœ… å·²å­˜åœ¨ - Pythonä¾èµ–åˆ—è¡¨
â”œâ”€â”€ run_server.py                 # âœ… å·²å­˜åœ¨ - åŽç«¯å¯åŠ¨è„šæœ¬
â”‚
â””â”€â”€ frontend/                     # å‰ç«¯ç›®å½•
    â”œâ”€â”€ Dockerfile.frontend       # âš ï¸ éœ€è¦åˆ›å»º - å‰ç«¯Dockeré•œåƒé…ç½®
    â””â”€â”€ nginx.conf                # âš ï¸ éœ€è¦åˆ›å»º - å‰ç«¯Nginxé…ç½®
```

---

## 1ï¸âƒ£ Dockerfileï¼ˆåŽç«¯ï¼‰- éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/Dockerfile
```

### ðŸ“ å†…å®¹

```dockerfile
# åŽç«¯æœåŠ¡ Dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    build-essential \
    ffmpeg \
    git \
    curl \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.linux.txt requirements.txt

# å®‰è£… Python ä¾èµ–
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶é¡¹ç›®æ–‡ä»¶
COPY . .

# åˆ›å»ºå¿…è¦çš„ç›®å½•
RUN mkdir -p cache logs topics ads videos backgrounds avatars live2d-models web_tool models characters

# è®¾ç½®çŽ¯å¢ƒå˜é‡
ENV PYTHONUNBUFFERED=1
ENV PYTHONPATH=/app
ENV HF_HOME=/app/models
ENV MODELSCOPE_CACHE=/app/models

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD python -c "import requests; requests.get('http://localhost:12393/health')" || exit 1

# æš´éœ²ç«¯å£
EXPOSE 12393

# å¯åŠ¨æœåŠ¡
CMD ["python", "run_server.py"]
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **åŸºç¡€é•œåƒ**: Python 3.11 slimç‰ˆæœ¬
- **ç³»ç»Ÿä¾èµ–**: å®‰è£…ffmpegã€gitã€curlç­‰
- **Pythonä¾èµ–**: ä»Ž`requirements.linux.txt`å®‰è£…
- **å·¥ä½œç›®å½•**: `/app`
- **æš´éœ²ç«¯å£**: 12393
- **å¯åŠ¨å‘½ä»¤**: `python run_server.py`

---

## 2ï¸âƒ£ docker-compose.yml - éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/docker-compose.yml
```

### ðŸ“ å†…å®¹

```yaml
version: '3.8'

services:
  # ==================== åŽç«¯æœåŠ¡ ====================
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: theproject-san-backend
    environment:
      - CLIENT_ID=${CLIENT_ID:-client_001}
      - PYTHONUNBUFFERED=1
      - PYTHONPATH=/app
      - HF_HOME=/app/models
      - MODELSCOPE_CACHE=/app/models
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - GROQ_API_KEY=${GROQ_API_KEY:-}
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID:-}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY:-}
      - AWS_REGION=${AWS_REGION:-us-east-1}
      - S3_BUCKET=${S3_BUCKET:-}
    volumes:
      - ./conf.yaml:/app/conf.yaml:ro
      - ./cache:/app/cache
      - ./logs:/app/logs
      - ./topics:/app/topics
      - ./ads:/app/ads
      - ./videos:/app/videos
      - ./backgrounds:/app/backgrounds
      - ./avatars:/app/avatars
      - ./live2d-models:/app/live2d-models
      - ./web_tool:/app/web_tool
      - ./models:/app/models
      - ./characters:/app/characters
    restart: unless-stopped
    networks:
      - theproject-network
    healthcheck:
      test: ["CMD", "python", "-c", "import requests; requests.get('http://localhost:12393/health')"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

  # ==================== å‰ç«¯æœåŠ¡ ====================
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.frontend
    container_name: theproject-san-frontend
    environment:
      - VITE_API_BASE_URL=http://backend:12393
    depends_on:
      backend:
        condition: service_healthy
    restart: unless-stopped
    networks:
      - theproject-network

  # ==================== Caddy åå‘ä»£ç† ====================
  caddy:
    image: caddy:2-alpine
    container_name: theproject-san-caddy
    ports:
      - "80:80"
      - "443:443"
      - "443:443/udp"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile:ro
      - caddy_data:/data
      - caddy_config:/config
    restart: unless-stopped
    depends_on:
      - frontend
      - backend
    networks:
      - theproject-network

networks:
  theproject-network:
    driver: bridge

volumes:
  caddy_data:
    driver: local
  caddy_config:
    driver: local
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **ä¸‰ä¸ªæœåŠ¡**: backendï¼ˆåŽç«¯ï¼‰ã€frontendï¼ˆå‰ç«¯ï¼‰ã€caddyï¼ˆåå‘ä»£ç†ï¼‰
- **ç½‘ç»œ**: æ‰€æœ‰æœåŠ¡åœ¨åŒä¸€Dockerç½‘ç»œä¸­
- **æ•°æ®å·**: å°†æœ¬åœ°ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œæ•°æ®æŒä¹…åŒ–
- **ç«¯å£æ˜ å°„**: Caddyæš´éœ²80å’Œ443ç«¯å£
- **å¥åº·æ£€æŸ¥**: åŽç«¯æœåŠ¡æœ‰å¥åº·æ£€æŸ¥ï¼Œå‰ç«¯ç­‰å¾…åŽç«¯å¥åº·åŽæ‰å¯åŠ¨

---

## 3ï¸âƒ£ Caddyfile - éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/Caddyfile
```

### ðŸ“ å†…å®¹

```caddyfile
# TheProjectSan åå‘ä»£ç†é…ç½®
# âš ï¸ é‡è¦ï¼šè¯·å°† your-domain.com æ›¿æ¢ä¸ºä½ çš„å®žé™…åŸŸå

your-domain.com {
    # æ—¥å¿—é…ç½®
    log {
        output file /data/logs/access.log
        format json
    }

    # å‰ç«¯é™æ€æ–‡ä»¶
    handle / {
        reverse_proxy frontend:3000 {
            header_up Host {host}
            header_up X-Real-IP {remote}
            header_up X-Forwarded-For {remote}
            header_up X-Forwarded-Proto {scheme}
        }
    }

    # åŽç«¯ API
    handle /api/* {
        reverse_proxy backend:12393 {
            header_up Host {host}
            header_up X-Real-IP {remote}
            header_up X-Forwarded-For {remote}
            header_up X-Forwarded-Proto {scheme}
        }
    }

    # WebSocket è¿žæŽ¥
    handle /client-ws {
        reverse_proxy backend:12393 {
            header_up Host {host}
            header_up X-Real-IP {remote}
            header_up X-Forwarded-For {remote}
            header_up X-Forwarded-Proto {scheme}
            header_up Upgrade {http.upgrade}
            header_up Connection {http.connection}
        }
    }

    # Web å·¥å…·
    handle /web-tool/* {
        reverse_proxy backend:12393 {
            header_up Host {host}
            header_up X-Real-IP {remote}
            header_up X-Forwarded-For {remote}
            header_up X-Forwarded-Proto {scheme}
        }
    }

    # é™æ€èµ„æº
    handle /cache/* {
        reverse_proxy backend:12393
    }

    handle /topics/* {
        reverse_proxy backend:12393
    }

    handle /ads/* {
        reverse_proxy backend:12393
    }

    handle /live2d-models/* {
        reverse_proxy backend:12393
    }

    handle /bg/* {
        reverse_proxy backend:12393
    }

    handle /avatars/* {
        reverse_proxy backend:12393
    }

    # å¥åº·æ£€æŸ¥
    handle /health {
        reverse_proxy backend:12393
    }

    handle /api/health {
        reverse_proxy backend:12393
    }

    # è‡ªåŠ¨ HTTPSï¼ˆLet's Encryptï¼‰
    tls {
        protocols tls1.2 tls1.3
    }
}
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **åŸŸåé…ç½®**: ç¬¬ä¸€è¡Œå¿…é¡»æ›¿æ¢ä¸ºä½ çš„å®žé™…åŸŸå
- **è·¯ç”±è§„åˆ™**: 
  - `/` â†’ å‰ç«¯ï¼ˆfrontend:3000ï¼‰
  - `/api/*` â†’ åŽç«¯APIï¼ˆbackend:12393ï¼‰
  - `/client-ws` â†’ WebSocketè¿žæŽ¥
  - `/web-tool/*` â†’ Webå·¥å…·
  - é™æ€èµ„æºè·¯å¾„ â†’ åŽç«¯
- **è‡ªåŠ¨HTTPS**: Caddyä¼šè‡ªåŠ¨ç”³è¯·Let's Encryptè¯ä¹¦

---

## 4ï¸âƒ£ .env - éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/.env
```

### ðŸ“ å†…å®¹

```bash
# å®¢æˆ·ID
CLIENT_ID=client_001

# API å¯†é’¥ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼Œæ›¿æ¢ä¸ºä½ çš„å®žé™…å¯†é’¥ï¼‰
OPENAI_API_KEY=sk-your-actual-openai-api-key-here
# ANTHROPIC_API_KEY=your_anthropic_api_key_here
# GROQ_API_KEY=your_groq_api_key_here

# åŸŸåé…ç½®ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®žé™…åŸŸåï¼‰
DOMAIN=your-domain.com

# å…¶ä»–é…ç½®
LOG_LEVEL=INFO
PYTHONUNBUFFERED=1
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **âš ï¸ ä¸æäº¤åˆ°Git**: æ­¤æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå·²åœ¨`.gitignore`ä¸­
- **å¿…é¡»ä¿®æ”¹**:
  - `OPENAI_API_KEY`: æ›¿æ¢ä¸ºä½ çš„å®žé™…APIå¯†é’¥
  - `DOMAIN`: æ›¿æ¢ä¸ºä½ çš„å®žé™…åŸŸå
- **å¯é€‰é…ç½®**: å…¶ä»–APIå¯†é’¥å’ŒS3é…ç½®ï¼ˆå¦‚æžœä½¿ç”¨ï¼‰

---

## 5ï¸âƒ£ conf.yaml - å·²å­˜åœ¨ï¼Œéœ€è¦é…ç½®

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/conf.yaml
```

### ðŸ“ å…³é”®é…ç½®é¡¹

```yaml
system_config:
  host: 0.0.0.0          # âš ï¸ å¿…é¡»ä¿æŒæ­¤å€¼ï¼ˆDockerçŽ¯å¢ƒéœ€è¦ï¼‰
  port: 12393
  media_server:
    client_id: 'client_001'  # âš ï¸ å¿…é¡»ä¸Ž .env ä¸­çš„ CLIENT_ID ä¸€è‡´

character_config:
  agent_config:
    llm_config:
      openai_llm:
        llm_api_key: ''  # âš ï¸ ç•™ç©ºï¼Œä½¿ç”¨çŽ¯å¢ƒå˜é‡ OPENAI_API_KEY
        model: 'gpt-4o-mini'
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **âš ï¸ ä¸æäº¤åˆ°Git**: æ­¤æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå·²åœ¨`.gitignore`ä¸­
- **host**: å¿…é¡»è®¾ç½®ä¸º`0.0.0.0`ï¼ˆDockerçŽ¯å¢ƒéœ€è¦ï¼‰
- **client_id**: å¿…é¡»ä¸Ž`.env`ä¸­çš„`CLIENT_ID`ä¸€è‡´
- **APIå¯†é’¥**: å¯ä»¥ç•™ç©ºï¼Œä½¿ç”¨çŽ¯å¢ƒå˜é‡

---

## 6ï¸âƒ£ requirements.linux.txt - å·²å­˜åœ¨

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/requirements.linux.txt
```

### ðŸ“ è¯´æ˜Ž
- åŒ…å«æ‰€æœ‰Pythonä¾èµ–åŒ…åŠå…¶ç‰ˆæœ¬
- ç”±`uv pip compile`è‡ªåŠ¨ç”Ÿæˆ
- Dockeræž„å»ºæ—¶ä¼šä½¿ç”¨æ­¤æ–‡ä»¶å®‰è£…ä¾èµ–

---

## 7ï¸âƒ£ frontend/Dockerfile.frontend - âš ï¸ éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/frontend/Dockerfile.frontend
```

### ðŸ“ å†…å®¹

```dockerfile
# AIå¹¿å‘Šå±ç³»ç»Ÿ - å‰ç«¯Dockerfile (ç”Ÿäº§çŽ¯å¢ƒ)
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci

# å¤åˆ¶æºä»£ç 
COPY . .

# æž„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆwebæ¨¡å¼ï¼Œè¾“å‡ºåˆ° dist/webï¼‰
RUN npm run build:web

# ===== ç”Ÿäº§é•œåƒ =====
FROM nginx:alpine

# å¤åˆ¶æž„å»ºäº§ç‰©
COPY --from=builder /app/dist/web /usr/share/nginx/html

# å¤åˆ¶Nginxé…ç½®
COPY nginx.conf /etc/nginx/conf.d/default.conf

# æš´éœ²ç«¯å£
EXPOSE 3000

# å¯åŠ¨Nginx
CMD ["nginx", "-g", "daemon off;"]
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **å¤šé˜¶æ®µæž„å»º**: å…ˆæž„å»ºå‰ç«¯ä»£ç ï¼Œå†å¤åˆ¶åˆ°Nginxé•œåƒ
- **æž„å»ºå‘½ä»¤**: ä½¿ç”¨ `npm run build:web`ï¼ˆwebæ¨¡å¼ï¼Œè¾“å‡ºåˆ° `dist/web`ï¼‰
- **ç«¯å£**: æš´éœ²3000ç«¯å£
- **Nginxé…ç½®**: ä½¿ç”¨`frontend/nginx.conf`

---

## 8ï¸âƒ£ frontend/nginx.conf - âš ï¸ éœ€è¦åˆ›å»º

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/frontend/nginx.conf
```

### ðŸ“ å†…å®¹

```nginx
server {
    listen 3000;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    # GzipåŽ‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json application/javascript;

    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # SPAè·¯ç”±æ”¯æŒ - æ‰€æœ‰è·¯ç”±éƒ½è¿”å›žindex.html
    location / {
        try_files $uri $uri/ /index.html;
    }

    # å¥åº·æ£€æŸ¥ç«¯ç‚¹
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **SPAæ”¯æŒ**: æ‰€æœ‰è·¯ç”±éƒ½è¿”å›ž`index.html`ï¼Œæ”¯æŒå‰ç«¯è·¯ç”±
- **GzipåŽ‹ç¼©**: å¯ç”¨GzipåŽ‹ç¼©ï¼Œæå‡åŠ è½½é€Ÿåº¦
- **é™æ€èµ„æºç¼“å­˜**: é™æ€èµ„æºç¼“å­˜1å¹´
- **å®‰å…¨å¤´**: æ·»åŠ åŸºæœ¬å®‰å…¨å“åº”å¤´
- **å¥åº·æ£€æŸ¥**: `/health`ç«¯ç‚¹ç”¨äºŽå®¹å™¨å¥åº·æ£€æŸ¥

---

## 9ï¸âƒ£ mcp_servers.json - âš ï¸ éœ€è¦åˆ›å»ºæˆ–é…ç½®

### ðŸ“ ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/mcp_servers.json
```

### ðŸ“ å†…å®¹

```json
{
    "mcp_servers": {
      "advertisement-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.advertisement_server", "--ads-dir=ads"],
        "env": {
          "PYTHONPATH": ".",
          "CLIENT_ID": "client_001"
        },
        "timeout": 30
      },
      "topic-introduction-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.topic_introduction_server", "--topics-dir=topics"],
        "env": {
          "PYTHONPATH": ".",
          "CLIENT_ID": "client_001"
        },
        "timeout": 30
      },
      "time": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.time_server", "--timezone=Asia/Tokyo"],
        "env": {
          "PYTHONPATH": "."
        },
        "timeout": 30
      },
      "weather-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.weather_server"],
        "env": {
          "PYTHONPATH": "."
        },
        "timeout": 30
      }
    }
}
```

### ðŸ”‘ å…³é”®è¯´æ˜Ž
- **âš ï¸ ä¸æäº¤åˆ°Git**: æ­¤æ–‡ä»¶å·²åœ¨`.gitignore`ä¸­ï¼ŒåŒ…å«çŽ¯å¢ƒç›¸å…³é…ç½®
- **CLIENT_ID**: å¿…é¡»ä¸Ž`.env`ä¸­çš„`CLIENT_ID`ä¿æŒä¸€è‡´
- **MCPæœåŠ¡å™¨**: é…ç½®äº†4ä¸ªMCPæœåŠ¡å™¨ï¼š
  - `advertisement-server`: å¹¿å‘Šç®¡ç†æœåŠ¡å™¨
  - `topic-introduction-server`: ä¸»é¢˜ä»‹ç»æœåŠ¡å™¨
  - `time`: æ—¶é—´æœåŠ¡å™¨ï¼ˆæ—¶åŒºï¼šAsia/Tokyoï¼‰
  - `weather-server`: å¤©æ°”æœåŠ¡å™¨
- **Dockeréƒ¨ç½²**: æ–‡ä»¶ä¼šè¢«æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼ˆé€šè¿‡docker-compose.ymlçš„volumesï¼‰

### ðŸ“ åˆ›å»ºæ–¹æ³•

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶
cat > mcp_servers.json << 'EOF'
{
    "mcp_servers": {
      "advertisement-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.advertisement_server", "--ads-dir=ads"],
        "env": {
          "PYTHONPATH": ".",
          "CLIENT_ID": "client_001"
        },
        "timeout": 30
      },
      "topic-introduction-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.topic_introduction_server", "--topics-dir=topics"],
        "env": {
          "PYTHONPATH": ".",
          "CLIENT_ID": "client_001"
        },
        "timeout": 30
      },
      "time": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.time_server", "--timezone=Asia/Tokyo"],
        "env": {
          "PYTHONPATH": "."
        },
        "timeout": 30
      },
      "weather-server": {
        "command": "python",
        "args": ["-m", "src.ai_chat.mcpp.weather_server"],
        "env": {
          "PYTHONPATH": "."
        },
        "timeout": 30
      }
    }
}
EOF

# ç¼–è¾‘æ–‡ä»¶ï¼Œå°† CLIENT_ID æ›¿æ¢ä¸ºå®žé™…å€¼ï¼ˆä¸Ž .env ä¸­çš„ä¸€è‡´ï¼‰
nano mcp_servers.json
```

---

## ðŸ“‹ åˆ›å»ºæ–‡ä»¶æ¸…å•

### âœ… å·²å­˜åœ¨çš„æ–‡ä»¶ï¼ˆæ— éœ€åˆ›å»ºï¼‰
- `requirements.linux.txt`
- `conf.yaml`ï¼ˆéœ€è¦é…ç½®ï¼Œä½†æ–‡ä»¶å·²å­˜åœ¨ï¼‰

### âš ï¸ éœ€è¦åˆ›å»ºçš„æ–‡ä»¶

1. **Dockerfile** - é¡¹ç›®æ ¹ç›®å½•
2. **docker-compose.yml** - é¡¹ç›®æ ¹ç›®å½•
3. **Caddyfile** - é¡¹ç›®æ ¹ç›®å½•
4. **.env** - é¡¹ç›®æ ¹ç›®å½•
5. **mcp_servers.json** - é¡¹ç›®æ ¹ç›®å½•ï¼ˆéœ€è¦é…ç½®CLIENT_IDï¼‰
6. **frontend/Dockerfile.frontend** - frontendç›®å½•
7. **frontend/nginx.conf** - frontendç›®å½•

---

## ðŸš€ å¿«é€Ÿåˆ›å»ºå‘½ä»¤

åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç¼ºå¤±çš„æ–‡ä»¶ï¼š

```bash
# 1. åˆ›å»º Dockerfile
cat > Dockerfile << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„Dockerfileå†…å®¹ï¼‰
EOF

# 2. åˆ›å»º docker-compose.yml
cat > docker-compose.yml << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„docker-compose.ymlå†…å®¹ï¼‰
EOF

# 3. åˆ›å»º Caddyfile
cat > Caddyfile << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„Caddyfileå†…å®¹ï¼Œè®°å¾—ä¿®æ”¹åŸŸåï¼‰
EOF

# 4. åˆ›å»º .env
cat > .env << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„.envå†…å®¹ï¼Œè®°å¾—ä¿®æ”¹APIå¯†é’¥å’ŒåŸŸåï¼‰
EOF

# 5. åˆ›å»ºå‰ç«¯ Dockerfile
cat > frontend/Dockerfile.frontend << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„frontend/Dockerfile.frontendå†…å®¹ï¼‰
EOF

# 6. åˆ›å»ºå‰ç«¯ Nginx é…ç½®
cat > frontend/nginx.conf << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„frontend/nginx.confå†…å®¹ï¼‰
EOF

# 7. åˆ›å»º MCP æœåŠ¡å™¨é…ç½®
cat > mcp_servers.json << 'EOF'
# ï¼ˆç²˜è´´ä¸Šé¢çš„mcp_servers.jsonå†…å®¹ï¼Œè®°å¾—ä¿®æ”¹CLIENT_IDï¼‰
EOF
```

**æˆ–è€…**ä½¿ç”¨ç¼–è¾‘å™¨ï¼ˆnano/viï¼‰é€ä¸ªåˆ›å»ºï¼š

```bash
nano Dockerfile
nano docker-compose.yml
nano Caddyfile
nano .env
nano mcp_servers.json
nano frontend/Dockerfile.frontend
nano frontend/nginx.conf
```

---

## âš ï¸ é‡è¦æé†’

1. **ä¿®æ”¹åŸŸå**: åœ¨`Caddyfile`å’Œ`.env`ä¸­éƒ½è¦æ›¿æ¢`your-domain.com`ä¸ºå®žé™…åŸŸå
2. **ä¿®æ”¹APIå¯†é’¥**: åœ¨`.env`ä¸­æ›¿æ¢`OPENAI_API_KEY`ä¸ºå®žé™…å¯†é’¥
3. **æ£€æŸ¥é…ç½®**: ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶ä¸­çš„`CLIENT_ID`/`client_id`ä¿æŒä¸€è‡´ï¼š
   - `.env` ä¸­çš„ `CLIENT_ID`
   - `conf.yaml` ä¸­çš„ `client_id`
   - `mcp_servers.json` ä¸­çš„ `CLIENT_ID`ï¼ˆåœ¨advertisement-serverå’Œtopic-introduction-serverçš„envä¸­ï¼‰
4. **ä¸è¦æäº¤æ•æ„Ÿæ–‡ä»¶**: `.env`ã€`conf.yaml`å’Œ`mcp_servers.json`å·²åœ¨`.gitignore`ä¸­ï¼Œä¸è¦æäº¤åˆ°Git

---

## ðŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´éƒ¨ç½²æ­¥éª¤.md](./å®Œæ•´éƒ¨ç½²æ­¥éª¤.md) - è¯¦ç»†çš„éƒ¨ç½²æ­¥éª¤
- [DEPLOYMENT.md](./DEPLOYMENT.md) - éƒ¨ç½²å‚è€ƒæ–‡æ¡£

